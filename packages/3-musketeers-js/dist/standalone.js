(()=>{var b=!1;function k(e){b=e}var a={info:(...e)=>w(1,...e),warn:(...e)=>w(2,...e),error:(...e)=>w(3,...e)};function w(e,...t){if(b){let r=["\u{1F93A} %c[3-musketeers]"];switch(e){case 1:r.push("color: #06989A; font-weight: 600"),console.log(...r,...t);break;case 2:r.push("color: #C4A000; font-weight: 600"),console.warn(...r,...t);break;case 3:r.push("color: #CC0000; font-weight: 600"),console.error(...r,...t);break;default:break}}}var O=/\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)]/;function g(e){if(e==null)return String(e);let t=O.exec(Object.prototype.toString.call(Object(e)));return t?t[1].toLowerCase():"object"}function u(e){return g(e)==="array"}function P(e){return g(e)==="string"}function l(e,t){return Object.prototype.hasOwnProperty.call(Object(e),t)}function f(e){if(!e||g(e)!="object"||e.nodeType||e==e.window)return!1;try{if(e.constructor&&!l(e,"constructor")&&!l(e.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}let t;for(t in e);return t===void 0||l(e,t)}function _(e){return g(e)==="arguments"}function p(e,t){let r=!e._clear;for(let n in e)if(l(e,n)){let s=e[n];u(s)&&r?(u(t[n])||(t[n]=[]),p(s,t[n])):f(s)&&r?(f(t[n])||(t[n]={}),p(s,t[n])):t[n]=s}delete t._clear}function v(e,t){let r={},n=r,s=e.split(".");for(let o=0;o<s.length-1;o++)n=n[s[o]]={};return n[s[s.length-1]]=t,r}function A(e){return{set:(t,r)=>{p(v(t,r),e.model_)},get:t=>e.get(t)}}function I(e,t){P(e[0])||a.warn(`Error processing command, no command was run. The first argument must be of type string, but was of type ${typeof e[0]}.
The command run was ${e}`);let r=e[0].split("."),n=r.pop(),s=e.slice(1),o=t;for(let i=0;i<r.length;i++){if(o[r[i]]===void 0){a.warn(`Error processing command, no command was run as the object at ${r} was undefined.
The command run was ${e}`);return}o=o[r[i]]}try{o[n](...s)}catch{a.error(`An exception was thrown by the method ${n}, so no command was run.
The method was called on the data layer object at the location ${r}.`)}}var h=class{constructor(t,r={}){this.dataLayer_=t,this.listener_=r.listener||(()=>{}),this.listenToPast_=!!r.listenToPast,this.processed_=!1,this.executingListener_=!1,this.model_={},this.unprocessed_=[],this.abstractModelInterface_=A(this),r.debugMode&&k(!0);let n=this.dataLayer_.push;this.dataLayer_.push=(...s)=>{let o=[].slice.call(s,0),i=n.apply(this.dataLayer_,o);return this.processStates_(o),i},r.processNow&&this.process()}process(){this.processed_&&a.error("Process has already been run. This method should only run a single time to prepare the helper."),this.processed_=!0;let t=this.dataLayer_.length;for(let r=0;r<t;r++)this.processStates_([this.dataLayer_[r]],!this.listenToPast_)}get(t){let r=this.model_,n=t.split(".");for(let s=0;s<n.length;s++){if(r[n[s]]===void 0)return;r=r[n[s]]}return r}processStates_(t,r=!1){if(this.processed_&&(this.unprocessed_.push(...t),!this.executingListener_))for(;this.unprocessed_.length>0;){let n=this.unprocessed_.shift();if(u(n))I(n,this.model_);else if(!_(n))if(typeof n=="function")try{n.call(this.abstractModelInterface_)}catch(s){a.error(`An exception was thrown when running the method ${n}, execution was skipped.`,s)}else if(f(n))for(let s in n)p(v(s,n[s]),this.model_);else continue;r||(this.executingListener_=!0,this.listener_(this.model_,n),this.executingListener_=!1)}}};function c(e){let t=e,r={}.toString.call(e).slice(8,-1);if(r==="Set")return new Set([...e].map(n=>c(n)));if(r==="Map")return new Map([...e].map(([n,s])=>[c(n),c(s)]));if(r==="Date")return new Date(e.getTime());if(r==="RegExp")return RegExp(e.source,M(e));if(r==="Array"||r==="Object"){t=Array.isArray(e)?[]:{};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=c(e[n]))}return t}function M(e){if(typeof e.flags=="string")return e.flags;{let t=[];return e.global&&t.push("g"),e.ignoreCase&&t.push("i"),e.multiline&&t.push("m"),e.sticky&&t.push("y"),e.unicode&&t.push("u"),t.join("")}}var x=class{constructor(){this.providerName="provider"}static{this.providerName="provider"}static logAction(t,...r){a.info(`[${t}]`,...r)}saveOptions(t={}){t.mapTrackEvent&&(this.mapTrackEvent=t.mapTrackEvent)}getTrackEvent(t,r){return this.mapTrackEvent?this.mapTrackEvent(t,r):{eventName:t,params:r}}};function y(e,t){let r=e;return t&&Array.isArray(t)&&t.length>0&&(r=e.filter(n=>t.includes(n.providerName))),r}function T(e,t){let[r,n,s]=t;y(e,s).forEach(i=>{let d=c(n);i.pageView(r,d)})}function R(e,t){let[r,n,s,o]=t;y(e,s).forEach(d=>{let E=c(n);d.track(r,E,o)})}function L(e,t){let[r,n,s]=t;y(e,s).forEach(i=>{let d=c(n);i.identify(r,d)})}var m=class{constructor(t=[]){this.listener=(t,r)=>{let n=[...r].splice(0,r.length);switch(n.shift()){case"init":let o=n.shift(),i=this.getProviderInstance(o);if(!i){a.error(`Provider '${o}' not found`);return}this.providers.push(i),i.init(...n);break;case"track":R(this.providers,n);break;case"page":T(this.providers,n);break;case"identify":L(this.providers,n);break}};this.availableProviders=t,this.providers=[];let r=window.dataQueue||[];this.helper=new h(r,{listener:this.listener,listenToPast:!0,processNow:!0,debugMode:!0})}getProviderInstance(t){let r=this.availableProviders.find(n=>n.providerName===t);if(r)return new r}};var N=new m;window.t3musketeers=N;})();
